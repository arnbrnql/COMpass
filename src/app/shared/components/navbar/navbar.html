<nav class="navbar bg-base-100 shadow-md" role="navigation" aria-label="Main navigation">
  <div class="navbar-start">
    <a routerLink="/" class="btn btn-ghost text-xl flex items-center gap-2" aria-label="COMpass - Go to home page">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10" stroke-linecap="round" stroke-linejoin="round"/>
        <polygon points="12,2 10,10 12,12 14,10" fill="currentColor" opacity="0.8"/>
        <polygon points="12,22 14,14 12,12 10,14" fill="currentColor" opacity="0.3"/>
        <line x1="12" y1="2" x2="12" y2="6" stroke-linecap="round"/>
        <line x1="12" y1="18" x2="12" y2="22" stroke-linecap="round"/>
        <line x1="2" y1="12" x2="6" y2="12" stroke-linecap="round"/>
        <line x1="18" y1="12" x2="22" y2="12" stroke-linecap="round"/>
      </svg>
      <span>COMpass</span>
    </a>
  </div>

  <div class="navbar-center">
    @if (isAuthenticated() && hasActiveRole()) {
      <div class="join border border-base-300 rounded-lg overflow-hidden shadow-sm">
        <button
          class="join-item btn btn-sm"
          [class.btn-primary]="isMenteeActive()"
          [class.btn-ghost]="!isMenteeActive()"
          (click)="switchToRole('mentee')"
          [disabled]="isMenteeActive()"
          [attr.aria-label]="'Switch to mentee view'"
          [attr.aria-pressed]="isMenteeActive()"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
          Mentee
        </button>
        <button
          class="join-item btn btn-sm"
          [class.btn-primary]="isMentorActive()"
          [class.btn-ghost]="!isMentorActive()"
          (click)="switchToRole('mentor')"
          [disabled]="isMentorActive()"
          [attr.aria-label]="'Switch to mentor view'"
          [attr.aria-pressed]="isMentorActive()"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
          </svg>
          Mentor
        </button>
      </div>
    }
  </div>

  <div class="navbar-end">
    @if (isAuthenticated()) {
      <div class="dropdown dropdown-end">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar" aria-label="User menu" aria-expanded="false">
          <div class="w-10 rounded-full">
            <img
              [alt]="(currentUser()?.displayName || 'User') + ' avatar'"
              [src]="avatarSrc()"
              width="40"
              height="40"
            />
          </div>
        </div>
        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52" role="menu">
          <li role="none">
            <a routerLink="/profile/edit" class="justify-between" role="menuitem" aria-label="Edit profile">
              Profile
            </a>
          </li>
          <li role="none">
            <a (click)="logout()" role="menuitem" aria-label="Sign out" class="cursor-pointer">
              Logout
            </a>
          </li>
        </ul>
      </div>
    } @else {
      <a routerLink="/auth/login" class="btn btn-ghost" aria-label="Sign in to your account">Log In</a>
      <a routerLink="/auth/register" class="btn btn-primary ml-2" aria-label="Create a new account">Sign Up</a>
    }
  </div>
</nav>

@if (isUnlockModalOpen()) {
  <app-unlock-role-modal
    (close)="onModalClose()"
    (unlockSuccess)="onUnlockSuccess($event)"
  ></app-unlock-role-modal>
}

@if (showCalComSetup()) {
  <app-cal-com-setup-guide
    [isModalOpen]="showCalComSetup()"
    (closeModal)="closeCalComSetup()"
    (setupComplete)="onCalComSetupComplete($event)"
  />
}
